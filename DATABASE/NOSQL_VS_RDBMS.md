### MongoDB, Redis

---

> **NOSQL VS RDBMS**

몽고db와 레디스를 살펴보기전에 nosql과 rdbms를 비교하며 이해하는것이 도움이 될것 같다.

> **RDBMS**

RDBMS의 장점은 다음과 같습니다.

- 미리 정의된 스키마가 있어 명확한 데이터 구조를 보장합니다. 이러한 특징은 **데이터의 무결성**을 보장하고 또한 어떤 데이터가 포함되어 있는지 한눈에 알수 있습니다.
- 테이블을 정규화하여 데이터 중복성을 제거하여 **데이터의 정합성**을 보장할수 있습니다.
- 트랜잭션 기능을 통해 **ACID**를 보장합니다.

단점은 다음과 같습니다.

- 정규화된 테이블을 join 하여 원하는 데이터를 얻어야 하기 때문에 성능적 이슈가 발생한다.
- 스키마 구조가 유연하지 못해 변경이 어렵다.
- ACID를 보장하기 위한 여러가지 부가적인 작업들로 인한 overhead 발생
- 수평적 확장이 어렵다.

![acid_overhead](/images/acid_overhead.jpeg)

(실제로 읽고 쓰는데 필요한 부분은 12%밖에 안되고 나머지 88%의 부가적인 작업 발생 )

> **NOSQL**

NOSQL의 장점은 다음과 같습니다

- **유연한 스키마 구조**로 인하여 요구 사항이 변경되었을때 데이터베이스를 쉽게 변경 가능
- 일반적으로 데이터가 정규화 되어 있지 않고 필요한 데이터들이 한곳에 모여 있기때문에 join 연산이 필요하지 않아 **쿼리 속도가 빠르다.**
- ACID를 보장하기 위한 부가적인 작업을 하지 않기 때문에 rdbms에 비해 더 빠르다.
- 분산 아키텍쳐를 가지고 설계되었기 때문에 **수평적 확장**이 쉽다.

단점은 다음과 같습니다.

- 데이터가 중복될수 있고 ACID 트랜잭션을 지원하지 않아 **데이터의 무결성을 지키기 어렵다.**
- 데이터의 구조가 사전에 정의 되어 있지 않아 **스펙을 따로 관리**해야 한다.



> **언제 NOSQL을 선택해야 하는가?**

- 데이터의 무결성이 크게 중요하지 않을때
- 로그성 데이터와 같은 대용량 데이터를 저장할때



> **MongoDB**

몽고db는 **document-based** 의 nosql database입니다. 세부적인 특징은 다음과 같습니다.

- Schemaless 구조이다.
  - 각 데이터베이스에 저장된 Document는 각기 다른, 다양한 필드를 가질수 있다.
  - 각 필드는 서로 다른 데이터 타입을 가질수도 있다,
  - 다양한 특성을 가진 데이터들을 쉽게 저장할수 있다.
- Indexing을 지원한다.
  - RDBMS에서 지원하는 대부분의 인덱스를 지원하기 때문에 쿼리의 성능을 향상시킬수 있다.
- 읽기/쓰기 성능이 RDBMS에 비해 빠르다.

![mongodb_read_performance][/images/mongodb_read_performance.png]

![mongodb_write_performance][mongodb_vs_sql_performance_chart_cloudduggu.png]



> **정리**

위와 같은 좋은 특성들 때문에 mongodb는 만능 db인것처럼 생각하기 쉬울수 있습니다. 하지만 프로그래밍 세계에서는 모든것이 trade-off 관계에 있습니다. 따라서 위의 특성들을 가지기 위해 기존의 rdbms가 가지고 있던 장점을 포기해야만 합니다. mongodb는 **트랜잭션을 통한 데이터 무결성**을 보장하지 않습니다. 따라서 mongodb를 데이터베이스로 선택했다면 데이터 무결성이 중요하지 않은 경우에만 사용을 해야 합니다.



> **Redis**

Redis는 in-memory 기반의 nosql database입니다. 세부적인 특징은 다음과 같습니다.

- 영속성을 지원하는 in-memory 데이터 저장소
  - In-memory 기반이기 때문에 disk 기반의 데이터베이스에 비해 성능이 뛰어나다.
  - 디스크에 데이터를 저장하는 기능을 지원하여 영속성을 보장할수 있다.
- 다양한 자료구조를 지원
  - 개발의 편의성이 좋아진다.

- 싱글스레드 기반
  - 데이터를 atomic히게 유지가능
  - Long-time 명령 수행시 다른 작업들을 처리할수 없는 상태가 되기 때문에 비효율적으로 동작
  - 이벤트 루프 방식이기 때문에 컨텍스트 스위칭 오버헤드가 줄어든다.







